nikith@KrystalVerse:~/projects/real-time-streaming-analytics$ code readme.md
nikith@KrystalVerse:~/projects/real-time-streaming-analytics$ make up
â„¹ï¸  ==========================================
â„¹ï¸  ğŸš€ Starting stack (docker compose up -d)
â„¹ï¸  ==========================================
[+] Building 0.7s (29/29) FINISHED
 => [internal] load local bake definitions                                                                         0.0s
 => => reading from stdin 1.82kB                                                                                   0.0s
 => [event-generator internal] load build definition from Dockerfile                                               0.0s
 => => transferring dockerfile: 202B                                                                               0.0s
 => [metrics-api internal] load build definition from Dockerfile                                                   0.0s
 => => transferring dockerfile: 256B                                                                               0.0s
 => [spark-stream internal] load build definition from Dockerfile                                                  0.0s
 => => transferring dockerfile: 705B                                                                               0.0s
 => [event-generator internal] load metadata for docker.io/library/python:3.11-slim                                0.3s
 => [spark-stream internal] load metadata for docker.io/apache/spark:3.5.1-python3                                 0.0s
 => [spark-stream internal] load .dockerignore                                                                     0.0s
 => => transferring context: 2B                                                                                    0.0s
 => [spark-stream 1/4] FROM docker.io/apache/spark:3.5.1-python3@sha256:b49e3b73ce385c1693cc3294ec4b5b3882e9fa9bd  0.0s
 => => resolve docker.io/apache/spark:3.5.1-python3@sha256:b49e3b73ce385c1693cc3294ec4b5b3882e9fa9bd5fc599d4c7919  0.0s
 => CACHED [spark-stream 2/4] RUN pip install --no-cache-dir pandas psycopg2-binary pyarrow                        0.0s
 => CACHED [spark-stream 3/4] RUN useradd -m -u 1000 -s /bin/bash sparkuser || true                                0.0s
 => CACHED [spark-stream 4/4] RUN mkdir -p /tmp/spark /tmp/.ivy2 /opt/spark-checkpoints  && chown -R sparkuser:sp  0.0s
 => [spark-stream] exporting to image                                                                              0.1s
 => => exporting layers                                                                                            0.0s
 => => exporting manifest sha256:5465efc9e86a0e8d69164506a8e64147e2237633ed6805c94eae53a6574699c7                  0.0s
 => => exporting config sha256:0c5d8d21cd89e5060b0c8ae2b990f89d52e1cdbe2a504d9a535de4066e264301                    0.0s
 => => exporting attestation manifest sha256:516bec074440251adde2fe8324694d16bcb3298d5ba8823d3dcc29d27f384ccb      0.0s
 => => exporting manifest list sha256:9bc54fefa1ecb4ea9caac5bc3a3de3d3c04b8d4c5ea61867ecc389e90728eefb             0.0s
 => => naming to docker.io/library/real-time-streaming-analytics-spark-stream:latest                               0.0s
 => => unpacking to docker.io/library/real-time-streaming-analytics-spark-stream:latest                            0.0s
 => [spark-stream] resolving provenance for metadata file                                                          0.0s
 => [event-generator internal] load .dockerignore                                                                  0.0s
 => => transferring context: 2B                                                                                    0.0s
 => [metrics-api internal] load .dockerignore                                                                      0.0s
 => => transferring context: 2B                                                                                    0.0s
 => [metrics-api 1/5] FROM docker.io/library/python:3.11-slim@sha256:158caf0e080e2cd74ef2879ed3c4e697792ee65251c8  0.0s
 => => resolve docker.io/library/python:3.11-slim@sha256:158caf0e080e2cd74ef2879ed3c4e697792ee65251c8208b7afb5668  0.0s
 => [event-generator internal] load build context                                                                  0.0s
 => => transferring context: 68B                                                                                   0.0s
 => [metrics-api internal] load build context                                                                      0.0s
 => => transferring context: 64B                                                                                   0.0s
 => CACHED [metrics-api 2/5] WORKDIR /app                                                                          0.0s
 => CACHED [event-generator 3/5] COPY requirements.txt .                                                           0.0s
 => CACHED [event-generator 4/5] RUN pip install --no-cache-dir -r requirements.txt                                0.0s
 => CACHED [event-generator 5/5] COPY producer.py .                                                                0.0s
 => CACHED [metrics-api 3/5] COPY requirements.txt .                                                               0.0s
 => CACHED [metrics-api 4/5] RUN pip install --no-cache-dir -r requirements.txt                                    0.0s
 => CACHED [metrics-api 5/5] COPY main.py .                                                                        0.0s
 => [event-generator] exporting to image                                                                           0.1s
 => => exporting layers                                                                                            0.0s
 => => exporting manifest sha256:bea61ec8d28e1c3d2ce5ba5e82dc7098514970ac9cde3d9ba0bbc9e90989aa26                  0.0s
 => => exporting config sha256:7898fb46328cb3f3a3241c39296321458c5af0d432b516be455a49704db6a38b                    0.0s
 => => exporting attestation manifest sha256:bca64c085500e97d619aada5f5fee816090a24223f4b3162dd559a1815db88bd      0.0s
 => => exporting manifest list sha256:cc4ef448633a1c729a0dd984d2d7e76015cf583514d5e57a4c39bb29d33db9e3             0.0s
 => => naming to docker.io/library/real-time-streaming-analytics-event-generator:latest                            0.0s
 => => unpacking to docker.io/library/real-time-streaming-analytics-event-generator:latest                         0.0s
 => [metrics-api] exporting to image                                                                               0.1s
 => => exporting layers                                                                                            0.0s
 => => exporting manifest sha256:fee322ac1368bfd6f2f038de0e831249aa12ea29adffdb896268bdb2adc070cd                  0.0s
 => => exporting config sha256:20f5ca93a4e82f8df9f9ff6886caa58e68538c29e449e6028c230b24752aa3bf                    0.0s
 => => exporting attestation manifest sha256:eda4fdae49ab5e15add87a8673fd4922f18c1a87e17a59d308923c2525fbf4f8      0.0s
 => => exporting manifest list sha256:535b937b18e80f160c7b6619bf606a93b44b33f23b331eb8bedd4e2c75e1c5b5             0.0s
 => => naming to docker.io/library/real-time-streaming-analytics-metrics-api:latest                                0.0s
 => => unpacking to docker.io/library/real-time-streaming-analytics-metrics-api:latest                             0.0s
 => [event-generator] resolving provenance for metadata file                                                       0.0s
 => [metrics-api] resolving provenance for metadata file                                                           0.0s
[+] Running 12/12
 âœ” real-time-streaming-analytics-event-generator              B...                                                 0.0s
 âœ” real-time-streaming-analytics-metrics-api                  Built                                                0.0s
 âœ” real-time-streaming-analytics-spark-stream                 Buil...                                              0.0s
 âœ” Network real-time-streaming-analytics_default              C...                                                 0.0s
 âœ” Volume real-time-streaming-analytics_spark_tmp             Created                                              0.0s
 âœ” Volume real-time-streaming-analytics_spark_checkpoints     Created                                              0.0s
 âœ” Container real-time-streaming-analytics-postgres-1         Healthy                                              6.0s
 âœ” Container real-time-streaming-analytics-zookeeper-1        Started                                              0.8s
 âœ” Container real-time-streaming-analytics-kafka-1            Healthy                                             12.4s
 âœ” Container real-time-streaming-analytics-metrics-api-1      Started                                              6.4s
 âœ” Container real-time-streaming-analytics-event-generator-1  Started                                             12.5s
 âœ” Container real-time-streaming-analytics-spark-stream-1     Started                                             12.5s
â„¹ï¸  [1] Wait for Kafka to be healthy
â„¹ï¸  Waiting up to 180s: Kafka healthy

âœ… Kafka healthy
âœ… Kafka healthy âœ…
â„¹ï¸  [2] Wait for Postgres to be healthy
â„¹ï¸  Waiting up to 180s: Postgres healthy

âœ… Postgres healthy
âœ… Postgres healthy âœ…
â„¹ï¸  [3] Ensure Kafka topic exists: stream.events
âœ… Topic ready âœ…
â„¹ï¸  [4] Show running services
NAME                                              IMAGE                                           COMMAND                  SERVICE           CREATED         STATUS                            PORTS
real-time-streaming-analytics-event-generator-1   real-time-streaming-analytics-event-generator   "python producer.py"     event-generator   3 seconds ago   Up 1 second
real-time-streaming-analytics-kafka-1             confluentinc/cp-kafka:7.5.0                     "/etc/confluent/dockâ€¦"   kafka             3 seconds ago   Up 2 seconds (healthy)            0.0.0.0:9092->9092/tcp, [::]:9092->9092/tcp
real-time-streaming-analytics-metrics-api-1       real-time-streaming-analytics-metrics-api       "uvicorn main:app --â€¦"   metrics-api       3 seconds ago   Up 7 seconds (health: starting)   0.0.0.0:8000->8000/tcp, [::]:8000->8000/tcp
real-time-streaming-analytics-postgres-1          postgres:16                                     "docker-entrypoint.sâ€¦"   postgres          3 seconds ago   Up 2 seconds (healthy)            0.0.0.0:5432->5432/tcp, [::]:5432->5432/tcp
real-time-streaming-analytics-spark-stream-1      real-time-streaming-analytics-spark-stream      "/opt/entrypoint.sh â€¦"   spark-stream      3 seconds ago   Up 1 second (health: starting)
real-time-streaming-analytics-zookeeper-1         confluentinc/cp-zookeeper:7.5.0                 "/etc/confluent/dockâ€¦"   zookeeper         3 seconds ago   Up 2 seconds                      0.0.0.0:2181->2181/tcp, [::]:2181->2181/tcp
â„¹ï¸  ==========================================
â„¹ï¸  ğŸ§ª Running smoke tests
â„¹ï¸  ==========================================
==========================================
ğŸ§ª Smoke Tests (Kafka â†’ Spark â†’ Postgres â†’ API)
==========================================
â„¹ï¸  [1] Kafka topic exists
âœ… Topic OK: stream.events
â„¹ï¸  [2] Verify Kafka offsets advance (producer is alive)
â„¹ï¸  Offsets before=82 after=166
âœ… Offsets advancing âœ…
â„¹ï¸  [3] Spark container is running + healthy
â„¹ï¸  Waiting up to 120s: Spark healthy
.
âœ… Spark healthy
âœ… Spark healthy âœ…
â„¹ï¸  [4] Spark â†’ Postgres: confirm table has recent rows (last 5 minutes)
â„¹ï¸  Waiting up to 150s: Postgres has recent rows in stream_metrics_minute
...................................................................
âŒ Timeout waiting for: Postgres has recent rows in stream_metrics_minute
make: *** [Makefile:4: up] Error 1
nikith@KrystalVerse:~/projects/real-time-streaming-analytics$